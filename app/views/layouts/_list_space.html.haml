.panel.panel-default
  .panel-body.tab-display
    .row
      = form_for @listing, :html => {:id => "newlisting_form", :multipart => true} do |f|
        .col-md-12
          %ul.list-unstyled.list-inline.col-md-12.text-center
            %li
              = link_to "#name", :class => "inner-tab-link active" do
                Name & Desc.
            %li
              = link_to "#address", :class => "inner-tab-link" do
                Location
            %li
              = link_to "#dates", :class => "inner-tab-link" do
                Dates
            %li
              = link_to "#rates", :class => "inner-tab-link" do
                Rates
            %li
              = link_to "#upload-pictures", :class => "inner-tab-link" do
                Pics

        .col-md-12
          #name.inner-tab.active.col-md-12
            = f.text_field :name, :class => "form-control", :placeholder => "Name"
            = f.text_field :description, :id => "description", :class => "form-control", :placeholder => "Description", 'data-provider' =>  'summernote'
            %hr
            .row
              .col-md-12
                = button_tag :class => "next-btn next-btn-1 btn btn-default" do
                  Next
                  %i.fa.fa-chevron-right.fa-fw.fa-lg

          #address.inner-tab.col-md-12
            %h4
              Address
            = f.fields_for :location do |l|
              = l.text_field :street_address, :class => "form-control", :placeholder => "Street Address"
              .row
                .col-md-8
                  = l.text_field :city, :class => "form-control", :placeholder => "City"
                .col-md-2
                  = l.select :state, options_for_select(us_states), {:prompt => "State"}, class: "form-control"
                .col-md-2
                  = l.text_field :zip, :class => "form-control", :placeholder => "Zip"
            %br
            %br
            .row
              .col-md-12
                = button_tag :id => "name-next", :class => "next-btn next-btn-2 btn btn-default" do
                  Next
                  %i.fa.fa-chevron-right.fa-fw.fa-lg
                
          #rates.inner-tab.col-md-12
            %h4
              Rates
              %span.add-subtract-rate-forms
                %i#add-rate-form.fa.fa-plus-square-o.fa-lg
                %i#subtract-rate-form.fa.fa-minus-square-o.fa-lg

            / Show at least one "Rates" form
            = render :partial => 'listings/rates_form', :locals => { :f => f }
            %br
            %br
            .row
              .col-md-12
                = button_tag :id => "name-next", :class => "next-btn next-btn-3 btn btn-default" do
                  Next
                  %i.fa.fa-chevron-right.fa-fw.fa-lg

            #additional-rate-forms
            / I am not proud of this
            :javascript
              $(document).ready(function() {
                $("#add-rate-form").on("click", function(e) {
                  e.preventDefault();
                  $("#additional-rate-forms").append("#{ escape_javascript( render :partial => 'listings/rates_form', :locals => {:f => f} ) }");

                  if ($("#additional-rate-forms").children().length == parseInt("#{times.count}") - 1) {
                    $("#add-rate-form").hide();
                  } else {
                    $("#add-rate-form").show();
                  }
                });
              });

          #upload-pictures.inner-tab.col-md-12
            %h4
              Upload Pictures
            = f.fields_for :pictures do |p|
              = p.file_field :image, :multiple => true, :name => "image[]"
            .col-md-12
              = f.submit "Post Listing", :class => "btn btn-primary"

:javascript
  $(document).ready(function() {
    // Enable Summernote
    $('[data-provider="summernote"]').each(function(){
      $(this).summernote({
        height: 300
       });
    });

    $(".next-btn").on("click", function(e) {
      e.preventDefault();

      var index = $(this).index();
      $(".inner-tab-link").eq(index + 1).click();
    });

    $(".inner-tab-link").on("click", function(e) {
      e.preventDefault();

      var id = $(this).attr("href");

      $(".inner-tab-link").removeClass("active");
      $(this).addClass("active");

      $(".inner-tab").removeClass("active");
      $(id).addClass("active");
    });
  });